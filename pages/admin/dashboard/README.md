# 管理员面板

## 功能说明

管理员面板提供了全面的数据查看和统计分析功能，只有具有管理员角色的用户才能访问。

## 访问方式

1. **路径**: `/pages/admin/dashboard/dashboard`
2. **权限要求**: 用户必须具有 `admin` 角色

## 功能模块

### 1. 数据概览
- **儿童档案总数**: 显示系统中所有儿童档案的数量
- **评估记录总数**: 显示所有评估记录的数量
- **总体完成率**: 所有评估的总体完成率

### 2. 儿童档案列表
- 查看所有儿童档案的详细信息
- 包括：姓名、性别、出生日期、创建时间、诊断信息等
- 支持下拉刷新

### 3. 评估记录列表
- 查看所有评估记录
- 显示评估ID、创建时间、完成率等信息
- 支持下拉刷新

### 4. 统计分析
- **年龄段统计**: 
  - 按年龄段（1-3个月、3-6个月等）统计完成情况
  - 显示通过率、通过数量、总数量、评估次数
  - 可视化进度条展示
  
- **领域统计**:
  - 按功能领域（视知觉、精细动作、粗大动作等）统计完成情况
  - 显示通过率、通过数量、总数量、评估次数
  - 可视化进度条展示

## 权限设置

### 如何设置用户为管理员

1. **通过 uni-id-pages 管理**:
   - 访问 uni-id-pages 的用户管理功能
   - 将用户的 `role` 字段设置为包含 `'admin'`

2. **通过数据库直接设置**:
   ```javascript
   // 在 uniCloud 控制台或云函数中执行
   db.collection('uni-id-users')
     .doc('用户ID')
     .update({
       role: ['admin']
     })
   ```

3. **注册管理员账号**:
   - 访问 `/uni_modules/uni-id-pages/pages/register/register-admin`
   - 注册管理员账号（需要配置允许注册管理员）

## 技术实现

### 云函数
- **名称**: `getAdminData`
- **位置**: `uniCloud-aliyun/cloudfunctions/getAdminData/`
- **权限检查**: 使用 `assertAdmin` 确保只有管理员可以访问
- **数据获取**: 
  - 获取所有 child_profiles
  - 获取所有 assessments
  - 聚合统计 age bands 和 domains 数据

### 前端页面
- **位置**: `pages/admin/dashboard/dashboard.vue`
- **权限检查**: 通过解析 token 检查用户角色
- **数据展示**: 使用标签页切换不同视图

## 注意事项

1. **数据安全**: 
   - 管理员面板会显示所有用户的数据，请确保只有可信的管理员可以访问
   - 建议在生产环境中加强权限验证

2. **性能考虑**:
   - 如果数据量很大，建议添加分页功能
   - 可以考虑添加数据缓存机制

3. **数据更新**:
   - 支持下拉刷新更新数据
   - 数据实时性取决于云函数的执行时间

## 后续优化建议

1. 添加搜索和筛选功能
2. 添加数据导出功能
3. 添加图表可视化（如折线图、柱状图）
4. 添加时间范围筛选
5. 添加分页功能以支持大量数据
6. 添加数据详情查看功能

